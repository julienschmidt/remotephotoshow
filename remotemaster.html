<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Remote Master</title>
    <style type="text/css">
    html, body {
        height: 100%;
        width: 100%;
        overflow: hidden;
    }
    body {
        background: #000;
        color: #FFF;
        margin: 0;
        padding: 0;
    }
    #controlbar {
        position: absolute;
        bottom: 0;
        right: 0;
        z-index: 999;
    }
    iframe#photoshow {
        border: none;
        width: 100%;
        height: 100%;
        margin: 0;
    }
    </style>
</head>
<body>
    <section id="controlbar">
        <button onclick="prev()">Prev</button>
        <button onclick="next()">Next</button>
        <span id="cur"></span>
        <button onclick="reset()">Reset</button>
    </section>
    <iframe src="/" id="photoshow"></iframe>
</body>
<script type="text/javascript">
var iframe = document.getElementById("photoshow").contentWindow;

var oCur = document.getElementById("cur");
function updateCur() {
    oCur.innerHTML = "" + (iframe.imgID+1) + " / " + iframe.imgList.length;
}
iframe.setPhotoCallback = updateCur;

function sendCMD(params) {
    var req = iframe.newXMLHttp();
    req.open("POST", iframe.baseURL + "master", true);
    req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    req.send(params);
}
function prev() {
    var newID = iframe.imgID-1;
    if(newID < 0) {
        newID = iframe.imgList.length-1;
    }
    sendCMD("cmd=set&id="+newID);
}
function next() {
    var newID = (iframe.imgID+1)%iframe.imgList.length
    sendCMD("cmd=set&id="+newID);
}
function reset() {
    sendCMD("cmd=reset");
}
</script>
</html>
